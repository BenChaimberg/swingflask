{% extends 'base.html' %}
{% block head %}
{{ super() }}
		<title></title>
		<style>
			td:nth-child(1) {
				width:15%;
			}
			tr {
				vertical-align:top;
				background-color:#D3D3D3;
			}
			td span:nth-child(1) {
				font-weight:bold;
			}
			ul#notifyemail {
				list-style:none;
				display:inline;
				padding:0;
			}
			#content label {
				float:left;
			}
			#content input:not(#submit):not(#notifyemail-0):not(#notifyemail-1),textarea {
				float:right;
				width:75%;
			}
			textarea {
				height:100px;
			}
			#notifyemail label,.recaptcha_input_area input {
				float:none;
			}
			#submit {
				width:auto;
			}
			#notifyemail input {
				float:none;
				width:auto;
			}
			#notifyemail li {
				display:inline;
				padding-right:10px;
			}
			form div div {
				clear:right;
			}
			#forum-side a {
				color:white;
			}
			ul#forum-side {
				list-style:none;
				padding:0;
				margin:0 auto;
			}
			#forum-side li {
				margin:0 auto;
			}
			@media (max-width: 1024px) {
				#recaptcha_table td:nth-of-type(3) {
					display: none;
				}
			}
		</style>
		<script>
			$(document).ready(function(){
				$("#forum-side").offset({left:$("#content").offset().left+650,top:$("#top").offset().top});
				$("#top").click(function(){
					$('html, body').animate({scrollTop:0});
				});
				$("#bottom").click(function(){
					$('html, body').animate({scrollTop:$('body').height()});
				});
				$("title").html("Swing Paints Forum - {{ message.subject | safe }}");
				$("#subject").val("Re: {{ message.subject | safe }}");
				$("form").find("input, textarea").not("#csrf_token,#subject, #submit").val('');
				function display(name,email,time,subject,text) {
					var newRow  = document.getElementById("write").insertRow(-1);
					var newCell = newRow.insertCell(-1);
					var htmlNode = document.createElement('span');
					htmlNode.innerHTML = '<a href="mailto:'+email+'">'+name+'</a><br />';
					newCell.appendChild(htmlNode);
					var htmlNode2 = document.createElement('span');
					htmlNode2.innerHTML = time;
					newCell.appendChild(htmlNode2);
					var newCell2 = newRow.insertCell(-1);
					var htmlNode3 = document.createElement('span');
					$(newCell2).attr("id",time);
					htmlNode3.innerHTML = '<a href="#'+time+'">'+subject+'</a><br />';
					newCell2.appendChild(htmlNode3);
					var htmlNode4 = document.createElement('span');
					htmlNode4.innerHTML = text;
					newCell2.appendChild(htmlNode4);
				}
				display('{{ message.name }}','{{ message.email }}','{{ message.date | safe }}','{{ message.subject }}','{{ message.message | replace("\r","") | replace("\n","<br />") | replace("\'","\\\'") | safe }}');
				{% for reply in replies %}
					display('{{ reply.name }}','{{ reply.email }}','{{ reply.date | safe }}','{{ reply.subject }}','{{ reply.message | replace("\r","") | replace("\n","<br />") | replace("\'","\\\'") | safe }}');
				{% endfor %}
			});
		</script>
{% endblock %}
{% block categorytext %}Forum Message{% endblock %}
{% block content %}
		<table id="write">
			<tr style="background-color:#666666;color:white;">
				<td style="font-weight:bold;">From</td>
				<td style="font-weight:bold;">Message</td>
			</tr>
		</table>
		<h2>New message:</h2>
		<form method="POST" action="{{ url_for('.message',message_id=message.IDmessage) }}">
		{{ message_form.hidden_tag() }}
			<div style="float:left;width:100%;"><ul>
			{% for field in message_form %}
				{% for error in field.errors %}
					<li>{{ error | safe }}</li>
				{% endfor %}
			{% endfor %}
				</ul>
			{% for field in message_form %}
				<div>
				{% if loop.index == 1 %}
				{% else %}
					{% if field.type == 'RecaptchaField' %}
					{% else %}
						{{ field.label }}:
					{% endif %}
					{{ field }}
				{% endif %}
				</div>
			{% endfor %}
				<div><input id="submit" type="submit" value="Submit"></div>
		    </div>
		</form>
		<ul id="forum-side" style="position:fixed;color:white;top:150px;">
			<li><a id="top" href="#">[ top &#8593; ]</a></li>
			<li><a id="forum-back" href="/forum/1">[ forum &#8592; ]</a></li>
			<li><a id="bottom" href="#">[ bottom &#8595; ]</a></li>
		</ul>
{% endblock %}
